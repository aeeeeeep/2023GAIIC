
epoch 0




































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.16it/s]


































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:11<00:00,  1.78s/it]
{'cider': 0.0}
new best metric cider 0.0
epoch 1



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.15it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]




































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 158/160 [01:13<00:00,  2.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.14it/s]



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]




































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 159/160 [01:14<00:00,  2.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]




































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]



































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:11<00:00,  1.80s/it]
{'cider': 1.0211240191709156e-05}
new best metric cider 1.0211240191709156e-05
epoch 7



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]




































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.13it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]




































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:15<00:00,  2.13it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.14it/s]


































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [01:11<00:00,  1.80s/it]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]
{'cider': 0.5550086184354703}
new best metric cider 0.5550086184354703




































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 159/160 [01:14<00:00,  2.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.13it/s]



































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 157/160 [01:13<00:01,  2.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.14it/s]



































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.14it/s]
  0%|                                                                                                                                                | 0/160 [00:00<?, ?it/s]




































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.14it/s]




































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 158/160 [01:13<00:00,  2.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 160/160 [01:14<00:00,  2.14it/s]




















 58%|██████████████████████████████████████████████████████████████████████████████▍                                                        | 93/160 [00:45<00:32,  2.06it/s]
Traceback (most recent call last):
  File "train.py", line 177, in <module>
  File "train.py", line 116, in train
    adv_losses, _ = compute_batch(model, source, targets)
  File "train.py", line 30, in compute_batch
    pred = model(source[:, :conf['input_l']], targets[:, :conf['output_l']])
  File "/root/miniconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/root/miniconda3/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 166, in forward
    return self.module(*inputs[0], **kwargs[0])
  File "/root/miniconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/root/2023GAIIC/models.py", line 19, in forward
    return self.decoder(feature, outputs) #[B,L,n_token]
  File "/root/miniconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/root/2023GAIIC/models.py", line 76, in forward
    posit_index = torch.arange(caption.shape[1]).unsqueeze(0).repeat(caption.shape[0],1).to(caption.device) #(B,L)
KeyboardInterrupt